<html>
    <head>
        <style>
.chart {

}

.main text {
    font: 10px sans-serif;	
}

.axis line, .axis path {
    shape-rendering: crispEdges;
    stroke: black;
    fill: none;
}

circle {
    fill: steelblue;
}

</style>
<script type="text/javascript" src="{{STATIC_URL}}d3.js"></script>
<script src="{{STATIC_URL}}jquery.js"></script>
<script src="{{STATIC_URL}}three.min2.js"></script>
<script src="{{STATIC_URL}}d3.js"></script>

<script src="{{STATIC_URL}}protector.js"></script>
<script src="{{STATIC_URL}}CanvasRenderer.js"></script>

<script src="{{STATIC_URL}}stats.min.js"></script>
</head>
    
<body>
<script type="text/javascript">
	function return_target() {
      $.ajax({
          url: '../train/',
          type: "POST",
          data: {
              target: document.getElementById("target").value,
              csrfmiddlewaretoken: '{{ csrf_token }}'
          }, 
          success: function(response) {
              document.getElementById("answer").value = response;
          },
          //complete: function(response) {document.getElementById("answer").value = response;},
          error: function(xhr, textStatus, thrownError) {}
      });
  }
  
  function search_function()
{
    $.ajax({
            url: 'search/',
            type: "POST",
            data: {
                search_box: document.getElementById("search_textbox").value,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function(response) {
                document.getElementById("add_main_topic").value = document.getElementById("search_textbox").value;
                document.getElementById("add_text").value = response;
                add_text_function();
            },
            complete: function() {},
            error: function(xhr, textStatus, thrownError) {}
        });
}

function guess_function()
{
    guess_text_function();
}

function guess_text_function()
{
    $.ajax({
            url: 'guess/',
            type: "POST",
            data: {
                words: manager.text_adder.words.join(" ").replace(/[^\w\s]|_/g, function ($1) { return ' ' + $1 + ' ';}).replace(/[ ]+/g, ' '),
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function(response) {
                console.log(response);
                re = response.split(" ");
                re.splice(0,1);
                counter = 0;
                re.forEach(function (r)
                {
                    if(r == "yes")
                    {
                        document.getElementById("word_label_" + counter.toString()).style.fill = "red"
                    }
                    else
                    {
                        document.getElementById("word_label_" + counter.toString()).style.fill = "blue"
                    }
                    counter = counter + 1;
                });
            },
            complete: function() {},
            error: function(xhr, textStatus, thrownError) {console.log(thrownError);}
        });
}

function teach_function()
{
    tt = ""
    counter=0;
    manager.text_adder.words.forEach(function (r)
    {
        if (document.getElementById("word_label_" + counter.toString()).style.fill == "rgb(255, 0, 0)")
        {
            tt = tt + " " + "yes";
        }
        else if (document.getElementById("word_label_" + counter.toString()).style.fill == "rgb(0, 0, 255)")
        {
            tt = tt + " " +  "no";
        }
        counter = counter + 1;
    });
    $.ajax({
            url: 'teach/',
            type: "POST",
            data: {
                teach_words: manager.text_adder.words.join(" "),
                teach_targets: tt,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function(response) {
                alert("it worked");
            },
            complete: function() {},
            error: function(xhr, textStatus, thrownError) {console.log(thrownError);}
        });
}
</script>
<div style="display:none">
<input type="hidden" name="csrfmiddlewaretoken" value="$csrf_token" />
</div>
<section class="container">
    <div class="training">
      <h1>enter information</h1>
        <p><input type="text" id="target" name="target" value="" placeholder="target"></p>
        <p class="submit"><input type="submit" id="submit" name="commit" value="submit" onclick="return_target()">
        <br>
        <br>
        <textarea type="textarea" cols="60" rows="30" id="answer"></textarea>
        </p>
    </div>
  </section>
    </body>
</html>


